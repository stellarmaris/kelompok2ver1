{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c345308a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:30:35.800379Z",
     "iopub.status.busy": "2025-05-15T04:30:35.800097Z",
     "iopub.status.idle": "2025-05-15T04:30:35.804424Z",
     "shell.execute_reply": "2025-05-15T04:30:35.803635Z"
    },
    "papermill": {
     "duration": 0.014092,
     "end_time": "2025-05-15T04:30:35.805762",
     "exception": false,
     "start_time": "2025-05-15T04:30:35.791670",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#from : https://www.kaggle.com/code/suyue715/tfidfvectorizer/notebook dengan beberapa modifikasi karena method berubah nama di versi baru "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "34216ab9",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-05-15T04:30:35.817898Z",
     "iopub.status.busy": "2025-05-15T04:30:35.817410Z",
     "iopub.status.idle": "2025-05-15T04:31:04.621257Z",
     "shell.execute_reply": "2025-05-15T04:31:04.620287Z"
    },
    "papermill": {
     "duration": 28.811679,
     "end_time": "2025-05-15T04:31:04.622979",
     "exception": false,
     "start_time": "2025-05-15T04:30:35.811300",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ir-2025-spooky-author-identification\n",
      "\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2025-05-15 04:30:50.994192: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n",
      "WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n",
      "E0000 00:00:1747283451.235837      13 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n",
      "E0000 00:00:1747283451.307141      13 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load in \n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "\n",
    "from nltk.corpus import stopwords #buat pake tools stopwords punya nltk\n",
    "from nltk.tokenize import word_tokenize #buat pake tools tokenization punya nltk\n",
    "from nltk.stem import SnowballStemmer #buat pake tools stemmer (ngubah kata jadi kata dasar)\n",
    "# Input data files are available in the \"../input/\" directory.\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n",
    "\n",
    "from subprocess import check_output #ini buat cek yang ada di direktori apa aja\n",
    "print(check_output([\"ls\", \"../input\"]).decode(\"utf8\"))\n",
    "\n",
    "#sama-sama tools NLP, yang pertama spacy yang kedua teks blob, nanti bisa bantu saat proses tokenisasi stemming dkk, \n",
    "#nanti pakai yang library EN karena bahasa penulis horornya pakai EN\n",
    "import spacy #buat import spacy \n",
    "from textblob import TextBlob\n",
    "\n",
    "# Any results you write to the current directory are saved as output.\n",
    "from keras.preprocessing import sequence #import sequence buat model RNN/LSTM\n",
    "from tensorflow.keras.utils import to_categorical #impor fungsi mengubah label ke format one-hot encoding\n",
    "from keras.models import Sequential #buat model jaringan secara urut (satu-satu gitu)\n",
    "from keras.layers import Dense, Dropout, Activation, Embedding #buat jaringan saraf\n",
    "from keras.layers import LSTM #impor layer LSTM buat proses data secara sekuensial\n",
    "\n",
    "from sklearn.ensemble import RandomForestClassifier #buat klasifikasi berbasis banyak decision tree\n",
    "from sklearn.model_selection import train_test_split #buat pisahin data menjadi data train dan test\n",
    "from sklearn.metrics import confusion_matrix, classification_report #hitung confusion matriks sama buat report klasifikasi\n",
    "from sklearn.feature_extraction.text import CountVectorizer #ubah teks ke vektor berdasar jumlah kata\n",
    "from sklearn.decomposition import LatentDirichletAllocation #LDA untuk topik modelling\n",
    "from sklearn.feature_extraction.text import TfidfVectorizer #mengubah teks menjadi vektor berdasar TF-IDF\n",
    "from sklearn.decomposition import TruncatedSVD #buat reduksi dimensi setelah pake TF-IDF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b16975fa",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:04.637310Z",
     "iopub.status.busy": "2025-05-15T04:31:04.636140Z",
     "iopub.status.idle": "2025-05-15T04:31:04.823587Z",
     "shell.execute_reply": "2025-05-15T04:31:04.822687Z"
    },
    "papermill": {
     "duration": 0.19536,
     "end_time": "2025-05-15T04:31:04.825310",
     "exception": false,
     "start_time": "2025-05-15T04:31:04.629950",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Buat load datasets\n",
    "train = pd.read_csv('/kaggle/input/ir-2025-spooky-author-identification/train/train.csv')\n",
    "test = pd.read_csv('/kaggle/input/ir-2025-spooky-author-identification/test/test.csv')\n",
    "sample = pd.read_csv('/kaggle/input/ir-2025-spooky-author-identification/sample_submission/sample_submission.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dc389f64",
   "metadata": {
    "papermill": {
     "duration": 0.005775,
     "end_time": "2025-05-15T04:31:04.836746",
     "exception": false,
     "start_time": "2025-05-15T04:31:04.830971",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Preprocessing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d225606e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:04.849221Z",
     "iopub.status.busy": "2025-05-15T04:31:04.848891Z",
     "iopub.status.idle": "2025-05-15T04:31:04.884077Z",
     "shell.execute_reply": "2025-05-15T04:31:04.883052Z"
    },
    "papermill": {
     "duration": 0.043247,
     "end_time": "2025-05-15T04:31:04.885543",
     "exception": false,
     "start_time": "2025-05-15T04:31:04.842296",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "      <th>author_num</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>id26305</td>\n",
       "      <td>This process, however, afforded me no means of...</td>\n",
       "      <td>EAP</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>id17569</td>\n",
       "      <td>It never once occurred to me that the fumbling...</td>\n",
       "      <td>HPL</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>id11008</td>\n",
       "      <td>In his left hand was a gold snuff box, from wh...</td>\n",
       "      <td>EAP</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>id27763</td>\n",
       "      <td>How lovely is spring As we looked from Windsor...</td>\n",
       "      <td>MWS</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>id12958</td>\n",
       "      <td>Finding nothing else, not even gold, the Super...</td>\n",
       "      <td>HPL</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id                                               text author  \\\n",
       "0  id26305  This process, however, afforded me no means of...    EAP   \n",
       "1  id17569  It never once occurred to me that the fumbling...    HPL   \n",
       "2  id11008  In his left hand was a gold snuff box, from wh...    EAP   \n",
       "3  id27763  How lovely is spring As we looked from Windsor...    MWS   \n",
       "4  id12958  Finding nothing else, not even gold, the Super...    HPL   \n",
       "\n",
       "   author_num  \n",
       "0           0  \n",
       "1           1  \n",
       "2           0  \n",
       "3           2  \n",
       "4           1  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Ini buat assign author ke kolom baru 'author_num'\n",
    "#0 -> 'EAP'\n",
    "#1 -> 'HPL'\n",
    "#2 -> 'MWS'\n",
    "train['author_num']=train['author'].apply({'EAP':0,  'HPL':1,'MWS':2}.get)\n",
    "train.head() #ini buat munculin datanya"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "6cb76ec4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:04.898729Z",
     "iopub.status.busy": "2025-05-15T04:31:04.897832Z",
     "iopub.status.idle": "2025-05-15T04:31:04.904575Z",
     "shell.execute_reply": "2025-05-15T04:31:04.903754Z"
    },
    "papermill": {
     "duration": 0.014841,
     "end_time": "2025-05-15T04:31:04.906207",
     "exception": false,
     "start_time": "2025-05-15T04:31:04.891366",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Ini buat assign feature sama targetnya\n",
    "X_text_train=train['text'].values\n",
    "X_text_test=test['text'].values\n",
    "y=train['author_num'].values\n",
    "num_labels = len(np.unique(train['author_num']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "0921c867",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:04.919386Z",
     "iopub.status.busy": "2025-05-15T04:31:04.919078Z",
     "iopub.status.idle": "2025-05-15T04:31:04.928637Z",
     "shell.execute_reply": "2025-05-15T04:31:04.927904Z"
    },
    "papermill": {
     "duration": 0.01798,
     "end_time": "2025-05-15T04:31:04.930303",
     "exception": false,
     "start_time": "2025-05-15T04:31:04.912323",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Ini buat define stopword dan buat stemming , librarynya pakai bahasa EN\n",
    "stop_words = set(stopwords.words('english'))\n",
    "stop_words.update(['.', ',', '\"', \"'\", ':', ';', '(', ')', '[', ']', '{', '}'])\n",
    "stemmer = SnowballStemmer('english')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7a8f650b",
   "metadata": {
    "papermill": {
     "duration": 0.005265,
     "end_time": "2025-05-15T04:31:04.941422",
     "exception": false,
     "start_time": "2025-05-15T04:31:04.936157",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# NLTK tokenize package"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "e13bcc4b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:04.953883Z",
     "iopub.status.busy": "2025-05-15T04:31:04.953450Z",
     "iopub.status.idle": "2025-05-15T04:31:13.392833Z",
     "shell.execute_reply": "2025-05-15T04:31:13.391931Z"
    },
    "papermill": {
     "duration": 8.447724,
     "end_time": "2025-05-15T04:31:13.394694",
     "exception": false,
     "start_time": "2025-05-15T04:31:04.946970",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Preprocess teks di train \n",
    "processed_train = []\n",
    "for doc in X_text_train:\n",
    "    tokens = word_tokenize(doc)\n",
    "    filtered = [word for word in tokens if word not in stop_words]\n",
    "    stemmed = [stemmer.stem(word) for word in filtered]\n",
    "    processed_train.append(stemmed)\n",
    "#Preprocess teks di test\n",
    "processed_test = []\n",
    "for doc in X_text_test:\n",
    "    tokens = word_tokenize(doc)\n",
    "    filtered = [word for word in tokens if word not in stop_words]\n",
    "    stemmed = [stemmer.stem(word) for word in filtered]\n",
    "    processed_test.append(stemmed)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "288615a3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.407775Z",
     "iopub.status.busy": "2025-05-15T04:31:13.406957Z",
     "iopub.status.idle": "2025-05-15T04:31:13.412285Z",
     "shell.execute_reply": "2025-05-15T04:31:13.411502Z"
    },
    "papermill": {
     "duration": 0.013162,
     "end_time": "2025-05-15T04:31:13.413624",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.400462",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'It never once occurred to me that the fumbling might be a mere mistake.'"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#ini buat coba X_text_train / testing output. Output yang muncul itu indeks 1 dari X_text_train\n",
    "X_text_train[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "39660457",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.426044Z",
     "iopub.status.busy": "2025-05-15T04:31:13.425625Z",
     "iopub.status.idle": "2025-05-15T04:31:13.431136Z",
     "shell.execute_reply": "2025-05-15T04:31:13.430381Z"
    },
    "papermill": {
     "duration": 0.013179,
     "end_time": "2025-05-15T04:31:13.432459",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.419280",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['it', 'never', 'occur', 'fumbl', 'might', 'mere', 'mistak']"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#ini buat coba tes processed_train / testing output. Output itu indeks 1 dari X_text_train yang udah di tokenisasi, udah di filter dari stopwords dan udah di stem (diubah ke bentuk dasar)\n",
    "processed_train[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "1f87fbb7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.445359Z",
     "iopub.status.busy": "2025-05-15T04:31:13.444783Z",
     "iopub.status.idle": "2025-05-15T04:31:13.454036Z",
     "shell.execute_reply": "2025-05-15T04:31:13.453099Z"
    },
    "papermill": {
     "duration": 0.017179,
     "end_time": "2025-05-15T04:31:13.455407",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.438228",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#ini buat nambah kolom processed_train ke tabel test \n",
    "train['processed_train']=processed_train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "df45fd9d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.468230Z",
     "iopub.status.busy": "2025-05-15T04:31:13.467550Z",
     "iopub.status.idle": "2025-05-15T04:31:13.478697Z",
     "shell.execute_reply": "2025-05-15T04:31:13.477596Z"
    },
    "papermill": {
     "duration": 0.018933,
     "end_time": "2025-05-15T04:31:13.480109",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.461176",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "      <th>author_num</th>\n",
       "      <th>processed_train</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>id26305</td>\n",
       "      <td>This process, however, afforded me no means of...</td>\n",
       "      <td>EAP</td>\n",
       "      <td>0</td>\n",
       "      <td>[this, process, howev, afford, mean, ascertain...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>id17569</td>\n",
       "      <td>It never once occurred to me that the fumbling...</td>\n",
       "      <td>HPL</td>\n",
       "      <td>1</td>\n",
       "      <td>[it, never, occur, fumbl, might, mere, mistak]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>id11008</td>\n",
       "      <td>In his left hand was a gold snuff box, from wh...</td>\n",
       "      <td>EAP</td>\n",
       "      <td>0</td>\n",
       "      <td>[in, left, hand, gold, snuff, box, caper, hill...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>id27763</td>\n",
       "      <td>How lovely is spring As we looked from Windsor...</td>\n",
       "      <td>MWS</td>\n",
       "      <td>2</td>\n",
       "      <td>[how, love, spring, as, look, windsor, terrac,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>id12958</td>\n",
       "      <td>Finding nothing else, not even gold, the Super...</td>\n",
       "      <td>HPL</td>\n",
       "      <td>1</td>\n",
       "      <td>[find, noth, els, even, gold, superintend, aba...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id                                               text author  \\\n",
       "0  id26305  This process, however, afforded me no means of...    EAP   \n",
       "1  id17569  It never once occurred to me that the fumbling...    HPL   \n",
       "2  id11008  In his left hand was a gold snuff box, from wh...    EAP   \n",
       "3  id27763  How lovely is spring As we looked from Windsor...    MWS   \n",
       "4  id12958  Finding nothing else, not even gold, the Super...    HPL   \n",
       "\n",
       "   author_num                                    processed_train  \n",
       "0           0  [this, process, howev, afford, mean, ascertain...  \n",
       "1           1     [it, never, occur, fumbl, might, mere, mistak]  \n",
       "2           0  [in, left, hand, gold, snuff, box, caper, hill...  \n",
       "3           2  [how, love, spring, as, look, windsor, terrac,...  \n",
       "4           1  [find, noth, els, even, gold, superintend, aba...  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#ini buat tes apakah kolom baru processed_train sudah masuk\n",
    "train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8f0945bc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.493994Z",
     "iopub.status.busy": "2025-05-15T04:31:13.493198Z",
     "iopub.status.idle": "2025-05-15T04:31:13.500559Z",
     "shell.execute_reply": "2025-05-15T04:31:13.499766Z"
    },
    "papermill": {
     "duration": 0.015791,
     "end_time": "2025-05-15T04:31:13.502063",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.486272",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['id', 'text', 'author', 'author_num', 'processed_train'], dtype='object')"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#ini buat tau kolom apa aja yang udah ada di tabel train\n",
    "train.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d32d0808",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.514974Z",
     "iopub.status.busy": "2025-05-15T04:31:13.514638Z",
     "iopub.status.idle": "2025-05-15T04:31:13.595469Z",
     "shell.execute_reply": "2025-05-15T04:31:13.594710Z"
    },
    "papermill": {
     "duration": 0.089233,
     "end_time": "2025-05-15T04:31:13.597129",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.507896",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#menggabungkan token hasil pre-processing menjadi kalimat utuh kemudian dijadikan satu di 'final_processed_text' di tabel train\n",
    "\n",
    "row_lst = []\n",
    "for lst in train.loc[:,'processed_train']:\n",
    "    text = ''\n",
    "    for word in lst:\n",
    "        text = text + ' ' + word\n",
    "    row_lst.append(text)\n",
    "\n",
    "train['final_processed_text'] = row_lst"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "677b9590",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.610031Z",
     "iopub.status.busy": "2025-05-15T04:31:13.609442Z",
     "iopub.status.idle": "2025-05-15T04:31:13.621572Z",
     "shell.execute_reply": "2025-05-15T04:31:13.620755Z"
    },
    "papermill": {
     "duration": 0.020036,
     "end_time": "2025-05-15T04:31:13.623042",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.603006",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>text</th>\n",
       "      <th>processed_test</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>id02310</td>\n",
       "      <td>Still, as I urged our leaving Ireland with suc...</td>\n",
       "      <td>[still, i, urg, leav, ireland, inquietud, impa...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>id24541</td>\n",
       "      <td>If a fire wanted fanning, it could readily be ...</td>\n",
       "      <td>[if, fire, want, fan, could, readili, fan, new...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>id00134</td>\n",
       "      <td>And when they had broken down the frail door t...</td>\n",
       "      <td>[and, broken, frail, door, found, two, clean, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>id27757</td>\n",
       "      <td>While I was thinking how I should possibly man...</td>\n",
       "      <td>[while, i, think, i, possibl, manag, without, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>id04081</td>\n",
       "      <td>I am not sure to what limit his knowledge may ...</td>\n",
       "      <td>[i, sure, limit, knowledg, may, extend]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id                                               text  \\\n",
       "0  id02310  Still, as I urged our leaving Ireland with suc...   \n",
       "1  id24541  If a fire wanted fanning, it could readily be ...   \n",
       "2  id00134  And when they had broken down the frail door t...   \n",
       "3  id27757  While I was thinking how I should possibly man...   \n",
       "4  id04081  I am not sure to what limit his knowledge may ...   \n",
       "\n",
       "                                      processed_test  \n",
       "0  [still, i, urg, leav, ireland, inquietud, impa...  \n",
       "1  [if, fire, want, fan, could, readili, fan, new...  \n",
       "2  [and, broken, frail, door, found, two, clean, ...  \n",
       "3  [while, i, think, i, possibl, manag, without, ...  \n",
       "4            [i, sure, limit, knowledg, may, extend]  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#memasukkan kolom 'processed_test' di tabel test\n",
    "test['processed_test']=processed_test\n",
    "test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3bd098d3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.636250Z",
     "iopub.status.busy": "2025-05-15T04:31:13.635945Z",
     "iopub.status.idle": "2025-05-15T04:31:13.683964Z",
     "shell.execute_reply": "2025-05-15T04:31:13.683047Z"
    },
    "papermill": {
     "duration": 0.056251,
     "end_time": "2025-05-15T04:31:13.685399",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.629148",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>text</th>\n",
       "      <th>processed_test</th>\n",
       "      <th>final_processed_test</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>id02310</td>\n",
       "      <td>Still, as I urged our leaving Ireland with suc...</td>\n",
       "      <td>[still, i, urg, leav, ireland, inquietud, impa...</td>\n",
       "      <td>still i urg leav ireland inquietud impati fat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>id24541</td>\n",
       "      <td>If a fire wanted fanning, it could readily be ...</td>\n",
       "      <td>[if, fire, want, fan, could, readili, fan, new...</td>\n",
       "      <td>if fire want fan could readili fan newspap go...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>id00134</td>\n",
       "      <td>And when they had broken down the frail door t...</td>\n",
       "      <td>[and, broken, frail, door, found, two, clean, ...</td>\n",
       "      <td>and broken frail door found two clean pick hu...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>id27757</td>\n",
       "      <td>While I was thinking how I should possibly man...</td>\n",
       "      <td>[while, i, think, i, possibl, manag, without, ...</td>\n",
       "      <td>while i think i possibl manag without one act...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>id04081</td>\n",
       "      <td>I am not sure to what limit his knowledge may ...</td>\n",
       "      <td>[i, sure, limit, knowledg, may, extend]</td>\n",
       "      <td>i sure limit knowledg may extend</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id                                               text  \\\n",
       "0  id02310  Still, as I urged our leaving Ireland with suc...   \n",
       "1  id24541  If a fire wanted fanning, it could readily be ...   \n",
       "2  id00134  And when they had broken down the frail door t...   \n",
       "3  id27757  While I was thinking how I should possibly man...   \n",
       "4  id04081  I am not sure to what limit his knowledge may ...   \n",
       "\n",
       "                                      processed_test  \\\n",
       "0  [still, i, urg, leav, ireland, inquietud, impa...   \n",
       "1  [if, fire, want, fan, could, readili, fan, new...   \n",
       "2  [and, broken, frail, door, found, two, clean, ...   \n",
       "3  [while, i, think, i, possibl, manag, without, ...   \n",
       "4            [i, sure, limit, knowledg, may, extend]   \n",
       "\n",
       "                                final_processed_test  \n",
       "0   still i urg leav ireland inquietud impati fat...  \n",
       "1   if fire want fan could readili fan newspap go...  \n",
       "2   and broken frail door found two clean pick hu...  \n",
       "3   while i think i possibl manag without one act...  \n",
       "4                   i sure limit knowledg may extend  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#menggabungkan token hasil pre-processing menjadi kalimat utuh kemudian dijadikan satu di 'final_processed_text' di tabel test\n",
    "#memasukkan kolom 'final_processed_test' ke tabel test\n",
    "row_lst = []\n",
    "for lst in test.loc[:,'processed_test']:\n",
    "    text = ''\n",
    "    for word in lst:\n",
    "        text = text + ' ' + word\n",
    "    row_lst.append(text)\n",
    "\n",
    "test['final_processed_test'] = row_lst\n",
    "\n",
    "test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4258b26d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.699147Z",
     "iopub.status.busy": "2025-05-15T04:31:13.698856Z",
     "iopub.status.idle": "2025-05-15T04:31:13.710418Z",
     "shell.execute_reply": "2025-05-15T04:31:13.709646Z"
    },
    "papermill": {
     "duration": 0.019922,
     "end_time": "2025-05-15T04:31:13.711661",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.691739",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>text</th>\n",
       "      <th>author</th>\n",
       "      <th>author_num</th>\n",
       "      <th>processed_train</th>\n",
       "      <th>final_processed_text</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>id26305</td>\n",
       "      <td>This process, however, afforded me no means of...</td>\n",
       "      <td>EAP</td>\n",
       "      <td>0</td>\n",
       "      <td>[this, process, howev, afford, mean, ascertain...</td>\n",
       "      <td>this process howev afford mean ascertain dime...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>id17569</td>\n",
       "      <td>It never once occurred to me that the fumbling...</td>\n",
       "      <td>HPL</td>\n",
       "      <td>1</td>\n",
       "      <td>[it, never, occur, fumbl, might, mere, mistak]</td>\n",
       "      <td>it never occur fumbl might mere mistak</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>id11008</td>\n",
       "      <td>In his left hand was a gold snuff box, from wh...</td>\n",
       "      <td>EAP</td>\n",
       "      <td>0</td>\n",
       "      <td>[in, left, hand, gold, snuff, box, caper, hill...</td>\n",
       "      <td>in left hand gold snuff box caper hill cut ma...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>id27763</td>\n",
       "      <td>How lovely is spring As we looked from Windsor...</td>\n",
       "      <td>MWS</td>\n",
       "      <td>2</td>\n",
       "      <td>[how, love, spring, as, look, windsor, terrac,...</td>\n",
       "      <td>how love spring as look windsor terrac sixtee...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>id12958</td>\n",
       "      <td>Finding nothing else, not even gold, the Super...</td>\n",
       "      <td>HPL</td>\n",
       "      <td>1</td>\n",
       "      <td>[find, noth, els, even, gold, superintend, aba...</td>\n",
       "      <td>find noth els even gold superintend abandon a...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id                                               text author  \\\n",
       "0  id26305  This process, however, afforded me no means of...    EAP   \n",
       "1  id17569  It never once occurred to me that the fumbling...    HPL   \n",
       "2  id11008  In his left hand was a gold snuff box, from wh...    EAP   \n",
       "3  id27763  How lovely is spring As we looked from Windsor...    MWS   \n",
       "4  id12958  Finding nothing else, not even gold, the Super...    HPL   \n",
       "\n",
       "   author_num                                    processed_train  \\\n",
       "0           0  [this, process, howev, afford, mean, ascertain...   \n",
       "1           1     [it, never, occur, fumbl, might, mere, mistak]   \n",
       "2           0  [in, left, hand, gold, snuff, box, caper, hill...   \n",
       "3           2  [how, love, spring, as, look, windsor, terrac,...   \n",
       "4           1  [find, noth, els, even, gold, superintend, aba...   \n",
       "\n",
       "                                final_processed_text  \n",
       "0   this process howev afford mean ascertain dime...  \n",
       "1             it never occur fumbl might mere mistak  \n",
       "2   in left hand gold snuff box caper hill cut ma...  \n",
       "3   how love spring as look windsor terrac sixtee...  \n",
       "4   find noth els even gold superintend abandon a...  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#buat nge tes tabel train kolomnya udah ketambah semua atau belum\n",
    "train.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "33783b9f",
   "metadata": {
    "papermill": {
     "duration": 0.005979,
     "end_time": "2025-05-15T04:31:13.724216",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.718237",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Named Entities"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "f69fe7ea",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:13.738254Z",
     "iopub.status.busy": "2025-05-15T04:31:13.737862Z",
     "iopub.status.idle": "2025-05-15T04:31:23.823764Z",
     "shell.execute_reply": "2025-05-15T04:31:23.822780Z"
    },
    "papermill": {
     "duration": 10.095057,
     "end_time": "2025-05-15T04:31:23.825585",
     "exception": false,
     "start_time": "2025-05-15T04:31:13.730528",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting en-core-web-sm==3.7.1\r\n",
      "  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.7.1/en_core_web_sm-3.7.1-py3-none-any.whl (12.8 MB)\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m12.8/12.8 MB\u001b[0m \u001b[31m83.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hRequirement already satisfied: spacy<3.8.0,>=3.7.2 in /usr/local/lib/python3.11/dist-packages (from en-core-web-sm==3.7.1) (3.7.5)\r\n",
      "Requirement already satisfied: spacy-legacy<3.1.0,>=3.0.11 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.0.12)\r\n",
      "Requirement already satisfied: spacy-loggers<2.0.0,>=1.0.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.0.5)\r\n",
      "Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.0.12)\r\n",
      "Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.0.11)\r\n",
      "Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.0.9)\r\n",
      "Requirement already satisfied: thinc<8.3.0,>=8.2.2 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (8.2.5)\r\n",
      "Requirement already satisfied: wasabi<1.2.0,>=0.9.1 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.1.3)\r\n",
      "Requirement already satisfied: srsly<3.0.0,>=2.4.3 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.5.1)\r\n",
      "Requirement already satisfied: catalogue<2.1.0,>=2.0.6 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.0.10)\r\n",
      "Requirement already satisfied: weasel<0.5.0,>=0.1.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.4.1)\r\n",
      "Requirement already satisfied: typer<1.0.0,>=0.3.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.15.1)\r\n",
      "Requirement already satisfied: tqdm<5.0.0,>=4.38.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (4.67.1)\r\n",
      "Requirement already satisfied: requests<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.32.3)\r\n",
      "Requirement already satisfied: pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.11.3)\r\n",
      "Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.1.6)\r\n",
      "Requirement already satisfied: setuptools in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (75.1.0)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (24.2)\r\n",
      "Requirement already satisfied: langcodes<4.0.0,>=3.2.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.5.0)\r\n",
      "Requirement already satisfied: numpy>=1.19.0 in /usr/local/lib/python3.11/dist-packages (from spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.26.4)\r\n",
      "Requirement already satisfied: language-data>=1.2 in /usr/local/lib/python3.11/dist-packages (from langcodes<4.0.0,>=3.2.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.3.0)\r\n",
      "Requirement already satisfied: mkl_fft in /usr/local/lib/python3.11/dist-packages (from numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.3.8)\r\n",
      "Requirement already satisfied: mkl_random in /usr/local/lib/python3.11/dist-packages (from numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.2.4)\r\n",
      "Requirement already satisfied: mkl_umath in /usr/local/lib/python3.11/dist-packages (from numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.1.1)\r\n",
      "Requirement already satisfied: mkl in /usr/local/lib/python3.11/dist-packages (from numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2025.1.0)\r\n",
      "Requirement already satisfied: tbb4py in /usr/local/lib/python3.11/dist-packages (from numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2022.1.0)\r\n",
      "Requirement already satisfied: mkl-service in /usr/local/lib/python3.11/dist-packages (from numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.4.1)\r\n",
      "Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.7.0)\r\n",
      "Requirement already satisfied: pydantic-core==2.33.1 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.33.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.12.2 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (4.13.1)\r\n",
      "Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,<3.0.0,>=1.7.4->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.4.0)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.4.1)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.10)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.3.0)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests<3.0.0,>=2.13.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2025.1.31)\r\n",
      "Requirement already satisfied: blis<0.8.0,>=0.7.8 in /usr/local/lib/python3.11/dist-packages (from thinc<8.3.0,>=8.2.2->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.7.11)\r\n",
      "Requirement already satisfied: confection<1.0.0,>=0.0.1 in /usr/local/lib/python3.11/dist-packages (from thinc<8.3.0,>=8.2.2->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.1.5)\r\n",
      "Requirement already satisfied: click>=8.0.0 in /usr/local/lib/python3.11/dist-packages (from typer<1.0.0,>=0.3.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (8.1.8)\r\n",
      "Requirement already satisfied: shellingham>=1.3.0 in /usr/local/lib/python3.11/dist-packages (from typer<1.0.0,>=0.3.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.5.4)\r\n",
      "Requirement already satisfied: rich>=10.11.0 in /usr/local/lib/python3.11/dist-packages (from typer<1.0.0,>=0.3.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (14.0.0)\r\n",
      "Requirement already satisfied: cloudpathlib<1.0.0,>=0.7.0 in /usr/local/lib/python3.11/dist-packages (from weasel<0.5.0,>=0.1.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.20.0)\r\n",
      "Requirement already satisfied: smart-open<8.0.0,>=5.2.1 in /usr/local/lib/python3.11/dist-packages (from weasel<0.5.0,>=0.1.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (7.1.0)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.0.2)\r\n",
      "Requirement already satisfied: marisa-trie>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from language-data>=1.2->langcodes<4.0.0,>=3.2.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.2.1)\r\n",
      "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich>=10.11.0->typer<1.0.0,>=0.3.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (3.0.0)\r\n",
      "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich>=10.11.0->typer<1.0.0,>=0.3.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2.19.1)\r\n",
      "Requirement already satisfied: wrapt in /usr/local/lib/python3.11/dist-packages (from smart-open<8.0.0,>=5.2.1->weasel<0.5.0,>=0.1.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.17.2)\r\n",
      "Requirement already satisfied: intel-openmp<2026,>=2024 in /usr/local/lib/python3.11/dist-packages (from mkl->numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2024.2.0)\r\n",
      "Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.11/dist-packages (from mkl->numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2022.1.0)\r\n",
      "Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.11/dist-packages (from tbb==2022.*->mkl->numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (1.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.11/dist-packages (from mkl_umath->numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2024.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.11/dist-packages (from intel-openmp<2026,>=2024->mkl->numpy>=1.19.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (2024.2.0)\r\n",
      "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich>=10.11.0->typer<1.0.0,>=0.3.0->spacy<3.8.0,>=3.7.2->en-core-web-sm==3.7.1) (0.1.2)\r\n",
      "\u001b[38;5;2m✔ Download and installation successful\u001b[0m\r\n",
      "You can now load the package via spacy.load('en_core_web_sm')\r\n",
      "\u001b[38;5;3m⚠ Restart to reload dependencies\u001b[0m\r\n",
      "If you are in a Jupyter or Colab notebook, you may need to restart Python in\r\n",
      "order to load all the package's dependencies. You can do this by selecting the\r\n",
      "'Restart kernel' or 'Restart runtime' option.\r\n"
     ]
    }
   ],
   "source": [
    "#ini buat install en_core_web_sm buat spacy\n",
    "!python -m spacy download en_core_web_sm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "0555467a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:23.841548Z",
     "iopub.status.busy": "2025-05-15T04:31:23.841234Z",
     "iopub.status.idle": "2025-05-15T04:31:24.706436Z",
     "shell.execute_reply": "2025-05-15T04:31:24.705133Z"
    },
    "papermill": {
     "duration": 0.875142,
     "end_time": "2025-05-15T04:31:24.708274",
     "exception": false,
     "start_time": "2025-05-15T04:31:23.833132",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#ini buat nge load en_core_web_sm\n",
    "nlp = spacy.load('en_core_web_sm')\n",
    "\n",
    "content = []\n",
    "for i in train['processed_train']:\n",
    "    content.append(i)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "446d15c4",
   "metadata": {
    "papermill": {
     "duration": 0.006817,
     "end_time": "2025-05-15T04:31:24.722651",
     "exception": false,
     "start_time": "2025-05-15T04:31:24.715834",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Use LDA to identify topic"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "1b57bb16",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:24.738368Z",
     "iopub.status.busy": "2025-05-15T04:31:24.737474Z",
     "iopub.status.idle": "2025-05-15T04:31:57.122611Z",
     "shell.execute_reply": "2025-05-15T04:31:57.121620Z"
    },
    "papermill": {
     "duration": 32.40204,
     "end_time": "2025-05-15T04:31:57.131628",
     "exception": false,
     "start_time": "2025-05-15T04:31:24.729588",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Topic 0\n",
      "old said house time man came night saw ancient mr long like street stone went light years great come things white room men way strange \n",
      "\n",
      "Topic 1\n",
      "door eyes saw took say long open did heart night head fear sun little length knew day opened end nature room main began came heard \n",
      "\n",
      "Topic 2\n",
      "man earth great did life time little old eyes like death voice said far light nature world years shall away means person year mind died \n",
      "\n",
      "Topic 3\n",
      "like night day little ye water far long sound heard head felt deep left city man old saw years things black came human half feet \n",
      "\n",
      "Topic 4\n",
      "time said thought old believe good did little say make general quite fact family great mean possible raymond day strange man hour course dupin jupiter \n",
      "\n",
      "Topic 5\n",
      "let day heard said life shall place things night like come did matter men heart man time know adrian brought half appeared say strange course \n",
      "\n",
      "Topic 6\n",
      "life saw long time words raymond friend father came length did thing mr felt days mother house soon grew great like know man young people \n",
      "\n",
      "Topic 7\n",
      "did love things man know despair thing heart hand thy tell eye life thou eyes heard read death room mind city shall half soon thee \n",
      "\n",
      "Topic 8\n",
      "eyes thought mind men hand love moment life knew feeling death raymond said heart world felt looked soul calm lay words light left tears joy \n",
      "\n",
      "Topic 9\n",
      "time said long door room feet far come man place open immediately came window sea wide body love appeared thing eyes old left seen great \n",
      "\n"
     ]
    }
   ],
   "source": [
    "# menjalankan Topic Modeling dengan metode LDA (Latent Dirichlet Allocation) pada data teks menggunakan CountVectorizer dari Scikit-lear\n",
    "from sklearn.decomposition import LatentDirichletAllocation, TruncatedSVD #ini buat import\n",
    "cv = CountVectorizer(stop_words='english') #ini buat ngatur stopwordnya dari EN\n",
    "cv.fit(train['text']) #ini buat train cv dari kolom teks\n",
    "X = cv.transform(train['text']) #ini buat ngubah dari teks ke matriks\n",
    "feature_names = cv.get_feature_names_out() #ini mengambil daftar kata yang dipake cv\n",
    "\n",
    "lda = LatentDirichletAllocation(n_components=10) #ini buat lda dengan topiknya ada 10\n",
    "lda.fit(X) #melatih LDA\n",
    "\n",
    "#ini buat simpan result ke dataframe\n",
    "results = pd.DataFrame(lda.components_,\n",
    "                      columns=feature_names)\n",
    "\n",
    "#ini intinya nge print\n",
    "for topic in range(10):\n",
    "    print('Topic', topic)\n",
    "    word_list = results.T[topic].sort_values(ascending=False).index\n",
    "    print(' '.join(word_list[0:25]), '\\n')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dddb2e7d",
   "metadata": {
    "papermill": {
     "duration": 0.006969,
     "end_time": "2025-05-15T04:31:57.145968",
     "exception": false,
     "start_time": "2025-05-15T04:31:57.138999",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# RandomForestClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "7c1434c0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:57.161673Z",
     "iopub.status.busy": "2025-05-15T04:31:57.161372Z",
     "iopub.status.idle": "2025-05-15T04:31:57.173495Z",
     "shell.execute_reply": "2025-05-15T04:31:57.172683Z"
    },
    "papermill": {
     "duration": 0.022105,
     "end_time": "2025-05-15T04:31:57.175286",
     "exception": false,
     "start_time": "2025-05-15T04:31:57.153181",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#membagi dataset menjadi data pelatihan (train) dan data pengujian (test)\n",
    "X_train, X_test, y_train, y_test = train_test_split(train['final_processed_text'],\n",
    "                                                   train['author_num'],\n",
    "                                                   test_size=0.33,\n",
    "                                                   random_state=8675309)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "56b56571",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:31:57.191286Z",
     "iopub.status.busy": "2025-05-15T04:31:57.190978Z",
     "iopub.status.idle": "2025-05-15T04:32:22.221599Z",
     "shell.execute_reply": "2025-05-15T04:32:22.220670Z"
    },
    "papermill": {
     "duration": 25.040468,
     "end_time": "2025-05-15T04:32:22.223119",
     "exception": false,
     "start_time": "2025-05-15T04:31:57.182651",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7078303930671619\n",
      "[[1971  239  452]\n",
      " [ 443 1123  260]\n",
      " [ 353  141 1480]]\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.71      0.74      0.73      2662\n",
      "           1       0.75      0.62      0.67      1826\n",
      "           2       0.68      0.75      0.71      1974\n",
      "\n",
      "    accuracy                           0.71      6462\n",
      "   macro avg       0.71      0.70      0.70      6462\n",
      "weighted avg       0.71      0.71      0.71      6462\n",
      "\n"
     ]
    }
   ],
   "source": [
    "#ini dipake buat bangun dan eval model klasifikasi pake random forest\n",
    "cv = CountVectorizer(stop_words='english')\n",
    "cv.fit(X_train)\n",
    "\n",
    "X_train_cv = cv.transform(X_train)\n",
    "X_test_cv = cv.transform(X_test)\n",
    "\n",
    "rf = RandomForestClassifier()\n",
    "rf.fit(X_train_cv, y_train)\n",
    "print(rf.score(X_test_cv, y_test))\n",
    "predictions = rf.predict(X_test_cv)\n",
    "print(confusion_matrix(y_test, predictions))\n",
    "print(classification_report(y_test, predictions))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6c823ce4",
   "metadata": {
    "papermill": {
     "duration": 0.007607,
     "end_time": "2025-05-15T04:32:22.238269",
     "exception": false,
     "start_time": "2025-05-15T04:32:22.230662",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# TfidfVectorizer() with English stop words"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "3f99ba9f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:32:22.254647Z",
     "iopub.status.busy": "2025-05-15T04:32:22.254092Z",
     "iopub.status.idle": "2025-05-15T04:32:46.120228Z",
     "shell.execute_reply": "2025-05-15T04:32:46.119168Z"
    },
    "papermill": {
     "duration": 23.875938,
     "end_time": "2025-05-15T04:32:46.121749",
     "exception": false,
     "start_time": "2025-05-15T04:32:22.245811",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7120086660476632\n",
      "[[2027  275  360]\n",
      " [ 443 1199  184]\n",
      " [ 415  184 1375]]\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.70      0.76      0.73      2662\n",
      "           1       0.72      0.66      0.69      1826\n",
      "           2       0.72      0.70      0.71      1974\n",
      "\n",
      "    accuracy                           0.71      6462\n",
      "   macro avg       0.71      0.70      0.71      6462\n",
      "weighted avg       0.71      0.71      0.71      6462\n",
      "\n"
     ]
    }
   ],
   "source": [
    "#ini intinya buat hitung tfidf\n",
    "tfidf = TfidfVectorizer(stop_words='english')\n",
    "tfidf.fit(X_train)\n",
    "\n",
    "X_train_tfidf = tfidf.transform(X_train)\n",
    "X_test_tfidf = tfidf.transform(X_test)\n",
    "test_tfidf = tfidf.transform(test['final_processed_test'])\n",
    "\n",
    "#ini buat + random forest classifier  \n",
    "rf = RandomForestClassifier()\n",
    "rf.fit(X_train_tfidf, y_train)\n",
    "print(rf.score(X_test_tfidf, y_test))\n",
    "predictions = rf.predict(X_test_tfidf)\n",
    "print(confusion_matrix(y_test, predictions))\n",
    "print(classification_report(y_test, predictions))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "b05bdf2c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:32:46.138710Z",
     "iopub.status.busy": "2025-05-15T04:32:46.138082Z",
     "iopub.status.idle": "2025-05-15T04:32:47.218957Z",
     "shell.execute_reply": "2025-05-15T04:32:47.218005Z"
    },
    "papermill": {
     "duration": 1.091077,
     "end_time": "2025-05-15T04:32:47.220565",
     "exception": false,
     "start_time": "2025-05-15T04:32:46.129488",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "pred=rf.predict_proba(test_tfidf) #predict probabilitas\n",
    "prob=pd.DataFrame(pred,columns=['EAP','HPL','MWS']) #buat kolom\n",
    "submit1=pd.concat([test, prob], axis=1) #buat gabungin test sama prob\n",
    "del submit1['text'] #hapus kolom text dari submit1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "c60bd3f3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:32:47.237418Z",
     "iopub.status.busy": "2025-05-15T04:32:47.237127Z",
     "iopub.status.idle": "2025-05-15T04:32:47.241971Z",
     "shell.execute_reply": "2025-05-15T04:32:47.240942Z"
    },
    "papermill": {
     "duration": 0.01511,
     "end_time": "2025-05-15T04:32:47.243532",
     "exception": false,
     "start_time": "2025-05-15T04:32:47.228422",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#hapus ['processed_test'] dari submit1\n",
    "del submit1['processed_test']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "8410a842",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:32:47.328071Z",
     "iopub.status.busy": "2025-05-15T04:32:47.327693Z",
     "iopub.status.idle": "2025-05-15T04:32:47.332219Z",
     "shell.execute_reply": "2025-05-15T04:32:47.331549Z"
    },
    "papermill": {
     "duration": 0.014381,
     "end_time": "2025-05-15T04:32:47.333491",
     "exception": false,
     "start_time": "2025-05-15T04:32:47.319110",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#hapus ['final_processed_test'] dari submit1\n",
    "del submit1['final_processed_test']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "0ff5f289",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:32:47.350400Z",
     "iopub.status.busy": "2025-05-15T04:32:47.349774Z",
     "iopub.status.idle": "2025-05-15T04:32:47.365257Z",
     "shell.execute_reply": "2025-05-15T04:32:47.364440Z"
    },
    "papermill": {
     "duration": 0.02521,
     "end_time": "2025-05-15T04:32:47.366581",
     "exception": false,
     "start_time": "2025-05-15T04:32:47.341371",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>EAP</th>\n",
       "      <th>HPL</th>\n",
       "      <th>MWS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>id02310</td>\n",
       "      <td>0.160000</td>\n",
       "      <td>0.070000</td>\n",
       "      <td>0.770000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>id24541</td>\n",
       "      <td>0.626364</td>\n",
       "      <td>0.120909</td>\n",
       "      <td>0.252727</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>id00134</td>\n",
       "      <td>0.310000</td>\n",
       "      <td>0.640000</td>\n",
       "      <td>0.050000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>id27757</td>\n",
       "      <td>0.434368</td>\n",
       "      <td>0.340526</td>\n",
       "      <td>0.225105</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>id04081</td>\n",
       "      <td>0.771048</td>\n",
       "      <td>0.093524</td>\n",
       "      <td>0.135429</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8387</th>\n",
       "      <td>id11749</td>\n",
       "      <td>0.765050</td>\n",
       "      <td>0.025002</td>\n",
       "      <td>0.209948</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8388</th>\n",
       "      <td>id10526</td>\n",
       "      <td>0.292678</td>\n",
       "      <td>0.220213</td>\n",
       "      <td>0.487109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8389</th>\n",
       "      <td>id13477</td>\n",
       "      <td>0.600000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.150000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8390</th>\n",
       "      <td>id13761</td>\n",
       "      <td>0.190000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.710000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8391</th>\n",
       "      <td>id04282</td>\n",
       "      <td>0.760000</td>\n",
       "      <td>0.150000</td>\n",
       "      <td>0.090000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8392 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           id       EAP       HPL       MWS\n",
       "0     id02310  0.160000  0.070000  0.770000\n",
       "1     id24541  0.626364  0.120909  0.252727\n",
       "2     id00134  0.310000  0.640000  0.050000\n",
       "3     id27757  0.434368  0.340526  0.225105\n",
       "4     id04081  0.771048  0.093524  0.135429\n",
       "...       ...       ...       ...       ...\n",
       "8387  id11749  0.765050  0.025002  0.209948\n",
       "8388  id10526  0.292678  0.220213  0.487109\n",
       "8389  id13477  0.600000  0.250000  0.150000\n",
       "8390  id13761  0.190000  0.100000  0.710000\n",
       "8391  id04282  0.760000  0.150000  0.090000\n",
       "\n",
       "[8392 rows x 4 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#hasil akhir\n",
    "submit1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "5f7c9d93",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-05-15T04:32:47.384341Z",
     "iopub.status.busy": "2025-05-15T04:32:47.383459Z",
     "iopub.status.idle": "2025-05-15T04:32:47.428856Z",
     "shell.execute_reply": "2025-05-15T04:32:47.428033Z"
    },
    "papermill": {
     "duration": 0.055674,
     "end_time": "2025-05-15T04:32:47.430445",
     "exception": false,
     "start_time": "2025-05-15T04:32:47.374771",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#buat submission\n",
    "submit1.to_csv('./kelompok2ver1.csv', index=False, header=True)"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 11486515,
     "sourceId": 96653,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 31012,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 139.746856,
   "end_time": "2025-05-15T04:32:50.320154",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-05-15T04:30:30.573298",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
